<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iPhone 16å…¨ç³»åˆ—Canvasé€‚é…æµ‹è¯•</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .device-info {
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .canvas-preview {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
        }
        .canvas-mock {
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
            font-weight: bold;
        }
        .panel-mock {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 10px;
            margin: 10px;
            color: white;
            text-align: center;
        }
        .debug-info {
            background: rgba(0, 0, 0, 0.3);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            margin-top: 10px;
        }
        .layout-portrait {
            flex-direction: column;
            align-items: center;
        }
        .layout-landscape {
            flex-direction: row;
            align-items: flex-start;
        }
        .iphone-indicator {
            background: rgba(255, 215, 0, 0.3);
            border: 2px solid rgba(255, 215, 0, 0.8);
            color: #333;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }
        h1, h2, h3 {
            color: white;
            text-align: center;
        }
        .info-text {
            color: rgba(255, 255, 255, 0.9);
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>iPhone 16 Series Canvas Adaptation Test</h1>
        
        <div id="iphone-indicator" class="iphone-indicator" style="display: none;">
            ğŸ¯ æ£€æµ‹åˆ°iPhone 16 Proå°ºå¯¸ï¼
        </div>
        
        <div class="device-info">
            <h3>è®¾å¤‡ä¿¡æ¯</h3>
            <div class="info-text">
                <p><strong>çª—å£å°ºå¯¸:</strong> <span id="window-size">-</span></p>
                <p><strong>é€»è¾‘åƒç´ :</strong> <span id="logical-pixels">-</span></p>
                <p><strong>è®¾å¤‡ç±»å‹:</strong> <span id="device-type">-</span></p>
                <p><strong>å¸ƒå±€æ¨¡å¼:</strong> <span id="layout-mode">-</span></p>
                <p><strong>iPhone 16ç³»åˆ—æ£€æµ‹:</strong> <span id="iphone-detection">-</span></p>
            </div>
        </div>

        <div class="canvas-preview" id="canvas-preview">
            <!-- åŠ¨æ€ç”Ÿæˆçš„å¸ƒå±€é¢„è§ˆ -->
        </div>

        <div class="debug-info" id="debug-info">
            <!-- è°ƒè¯•ä¿¡æ¯ -->
        </div>
    </div>

    <script>
        // æ›´æ–°çš„é€‚é…å¸¸é‡ï¼ˆä¸TypeScriptç‰ˆæœ¬åŒæ­¥ï¼‰
        const MOBILE_ADAPTATION = {
            PORTRAIT: {
                CANVAS_MARGIN: 10,
                PANEL_MARGIN: 10,
                SAFE_AREA_TOP: 10,
                SAFE_AREA_BOTTOM: 30,
                PANEL_HEIGHT: 180,
            },
            LANDSCAPE: {
                CANVAS_MARGIN: 1,
                PANEL_MARGIN: 10,
                SAFE_AREA_TOP: 1,
                SAFE_AREA_BOTTOM: 1,
                MIN_PANEL_WIDTH: 240,
                MAX_PANEL_WIDTH: 350,
            },
            MIN_CANVAS_SIZE: 240,
            MAX_CANVAS_SIZE: 400, // æé«˜åˆ°400pxä»¥å……åˆ†åˆ©ç”¨ç©ºé—´
        };

        const DEVICE_THRESHOLDS = {
            DESKTOP_MIN_WIDTH: 1024,
            TABLET_MIN_WIDTH: 640,
            PHONE_MAX_WIDTH: 639,
            DESKTOP_MOBILE_HEIGHT: 560,
        };

        function calculateMobilePortraitCanvasSize(windowWidth, windowHeight, panelHeight) {
            const { CANVAS_MARGIN, SAFE_AREA_TOP, SAFE_AREA_BOTTOM, PANEL_HEIGHT } = MOBILE_ADAPTATION.PORTRAIT;
            const { MIN_CANVAS_SIZE, MAX_CANVAS_SIZE } = MOBILE_ADAPTATION;

            // æ£€æµ‹iPhone 16ç³»åˆ—
            const iPhone16Detection = detectiPhone16Series(windowWidth, windowHeight);
            
            const actualPanelHeight = panelHeight || PANEL_HEIGHT;
            const availableWidth = windowWidth - CANVAS_MARGIN * 2;
            const availableHeight = windowHeight - actualPanelHeight - CANVAS_MARGIN - SAFE_AREA_TOP - SAFE_AREA_BOTTOM;

            let canvasSize;
            let maxCanvasSize = MAX_CANVAS_SIZE;

            // iPhone 16ç³»åˆ—ç‰¹æ®Šä¼˜åŒ–
            if (iPhone16Detection.detected && iPhone16Detection.orientation === 'portrait') {
                canvasSize = Math.min(availableWidth, availableHeight);
                
                // æ ¹æ®ä¸åŒiPhone 16æœºå‹è®¾ç½®ä¸åŒçš„æœ€å¤§ç”»å¸ƒå°ºå¯¸
                switch (iPhone16Detection.model) {
                    case 'iPhone 16e': // 390Ã—844
                        maxCanvasSize = Math.min(canvasSize, 355);
                        break;
                    case 'iPhone 16': // 393Ã—852
                        maxCanvasSize = Math.min(canvasSize, 360);
                        break;
                    case 'iPhone 16 Plus': // 430Ã—932  
                        maxCanvasSize = Math.min(canvasSize, 400);
                        break;
                    case 'iPhone 16 Pro': // 402Ã—874
                        maxCanvasSize = Math.min(canvasSize, 370);
                        break;
                    case 'iPhone 16 Pro Max': // 440Ã—956
                        maxCanvasSize = Math.min(canvasSize, 410);
                        break;
                    default:
                        maxCanvasSize = Math.min(canvasSize, 380);
                }
            } else if (windowWidth <= 460 && windowHeight >= 800) {
                // å…¶ä»–é«˜åˆ†è¾¨ç‡æ‰‹æœºç«–å±æ¨¡å¼ï¼ˆæ‰©å¤§èŒƒå›´ä»¥åŒ…å«iPhone 16 Pro Maxï¼‰
                canvasSize = Math.min(availableWidth, availableHeight);
                
                // æ ¹æ®å®½åº¦èŒƒå›´è¿›è¡Œä¼˜åŒ–
                if (windowWidth >= 430) {
                    // å¤§å±æ‰‹æœº (iPhone 16 Plus, Pro Maxç­‰)
                    maxCanvasSize = Math.min(canvasSize, 400);
                } else if (windowWidth >= 390) {
                    // ä¸­ç­‰å±å¹•æ‰‹æœº (iPhone 16, Proç­‰)
                    maxCanvasSize = Math.min(canvasSize, 370);
                } else {
                    // æ ‡å‡†å°ºå¯¸æ‰‹æœº
                    maxCanvasSize = Math.min(canvasSize, 340);
                }
            } else {
                // å…¶ä»–è®¾å¤‡ä½¿ç”¨æ ‡å‡†è®¡ç®—
                canvasSize = Math.min(availableWidth, availableHeight);
                maxCanvasSize = MAX_CANVAS_SIZE;
            }

            // åº”ç”¨æœ€å°å€¼å’Œæœ€å¤§å€¼é™åˆ¶
            canvasSize = Math.max(MIN_CANVAS_SIZE, Math.min(canvasSize, maxCanvasSize));

            return {
                canvasSize,
                canvasMargin: CANVAS_MARGIN,
                safeAreaTop: SAFE_AREA_TOP,
                safeAreaBottom: SAFE_AREA_BOTTOM,
                debug: {
                    windowSize: `${windowWidth}x${windowHeight}`,
                    availableWidth,
                    availableHeight,
                    actualPanelHeight,
                    iPhone16Model: iPhone16Detection.model,
                    iPhone16Detected: iPhone16Detection.detected,
                    maxCanvasSize,
                    isHighResolutionPhone: windowWidth <= 460 && windowHeight >= 800,
                }
            };
        }

        function calculateMobileLandscapeCanvasSize(windowWidth, windowHeight) {
            const { CANVAS_MARGIN, SAFE_AREA_TOP, MIN_PANEL_WIDTH, MAX_PANEL_WIDTH } = MOBILE_ADAPTATION.LANDSCAPE;
            const { MIN_CANVAS_SIZE, MAX_CANVAS_SIZE } = MOBILE_ADAPTATION;

            // æ£€æµ‹iPhone 16ç³»åˆ—
            const iPhone16Detection = detectiPhone16Series(windowWidth, windowHeight);

            // è®¡ç®—å¯ç”¨é«˜åº¦ï¼ˆè¿™é€šå¸¸æ˜¯é™åˆ¶å› ç´ ï¼‰
            const availableHeight = windowHeight - CANVAS_MARGIN * 2 - SAFE_AREA_TOP;

            let panelWidth = MIN_PANEL_WIDTH;
            let canvasSize;
            let maxCanvasSize = 400;

            // iPhone 16ç³»åˆ—ç‰¹æ®Šä¼˜åŒ–
            if (iPhone16Detection.detected && iPhone16Detection.orientation === 'landscape') {
                // æ ¹æ®ä¸åŒiPhone 16æœºå‹ä¼˜åŒ–é¢æ¿å®½åº¦å’Œç”»å¸ƒå°ºå¯¸
                // ä¼˜åŒ–ç­–ç•¥ï¼šè¾ƒå°å±å¹•éœ€è¦æ›´å®½çš„é¢æ¿ä»¥å®¹çº³tabæŒ‰é’®ï¼Œè¾ƒå¤§å±å¹•å¯ä»¥é€‚å½“å‡å°‘é¢æ¿å®½åº¦ç»™ç”»å¸ƒæ›´å¤šç©ºé—´
                switch (iPhone16Detection.model) {
                    case 'iPhone 16e': // 844Ã—390 (æœ€å°å±å¹•ï¼Œéœ€è¦è¶³å¤Ÿçš„é¢æ¿å®½åº¦)
                        panelWidth = 270; // å¢åŠ é¢æ¿å®½åº¦ç¡®ä¿tabæŒ‰é’®èˆ’é€‚æ˜¾ç¤º
                        maxCanvasSize = 350; // é€‚é…è¾ƒå°çš„é«˜åº¦
                        break;
                    case 'iPhone 16': // 852Ã—393 (å°å±å¹•ï¼Œéœ€è¦è¾ƒå®½é¢æ¿)
                        panelWidth = 270; // ä¸16eä¿æŒä¸€è‡´ï¼Œç¡®ä¿tabæŒ‰é’®æ˜¾ç¤ºè‰¯å¥½
                        maxCanvasSize = 360; // ç›¸åº”è°ƒæ•´ç”»å¸ƒå°ºå¯¸
                        break;
                    case 'iPhone 16 Plus': // 932Ã—430 (å¤§å±å¹•ï¼Œå¯ä»¥å¹³è¡¡é¢æ¿å’Œç”»å¸ƒ)
                        panelWidth = 250; // é€‚ä¸­çš„é¢æ¿å®½åº¦
                        maxCanvasSize = 410; // å……åˆ†åˆ©ç”¨å¤§å±ç©ºé—´
                        break;
                    case 'iPhone 16 Pro': // 874Ã—402 (ä¸­ç­‰å±å¹•)
                        panelWidth = 260; // é€‚ä¸­çš„é¢æ¿å®½åº¦
                        maxCanvasSize = 380; // å¹³è¡¡é¢æ¿å’Œç”»å¸ƒ
                        break;
                    case 'iPhone 16 Pro Max': // 956Ã—440 (æœ€å¤§å±å¹•ï¼Œå¯ä»¥ç»™ç”»å¸ƒæ›´å¤šç©ºé—´)
                        panelWidth = 260; // é€‚ä¸­çš„é¢æ¿å®½åº¦ï¼Œç»™ç”»å¸ƒæ›´å¤šç©ºé—´
                        maxCanvasSize = 420; // å……åˆ†åˆ©ç”¨è¶…å¤§å±ç©ºé—´
                        break;
                    default:
                        panelWidth = 260; // ç»Ÿä¸€é»˜è®¤å€¼ï¼Œç¡®ä¿å…¼å®¹æ€§
                        maxCanvasSize = 380;
                }
                
                const availableWidth = windowWidth - panelWidth - CANVAS_MARGIN * 2;
                canvasSize = Math.min(availableHeight, availableWidth);
                canvasSize = Math.min(canvasSize, maxCanvasSize);
                
            } else if (windowWidth >= 800 && windowHeight <= 460) {
                // å…¶ä»–é«˜åˆ†è¾¨ç‡æ‰‹æœºæ¨ªå±æ¨¡å¼ï¼ˆæ‰©å¤§èŒƒå›´ä»¥åŒ…å«iPhone 16 Pro Maxï¼‰
                
                // æ ¹æ®å±å¹•å®½åº¦åŠ¨æ€è°ƒæ•´
                if (windowWidth >= 950) {
                    // è¶…å¤§å±æ‰‹æœº (ç±»ä¼¼iPhone 16 Pro Max)
                    panelWidth = 240;
                    maxCanvasSize = 430;
                } else if (windowWidth >= 900) {
                    // å¤§å±æ‰‹æœº (ç±»ä¼¼iPhone 16 Plus)
                    panelWidth = 220;
                    maxCanvasSize = 420;
                } else if (windowWidth >= 850) {
                    // ä¸­ç­‰å±å¹•æ‰‹æœº (ç±»ä¼¼iPhone 16 Pro)
                    panelWidth = 220;
                    maxCanvasSize = 390;
                } else {
                    // æ ‡å‡†å°ºå¯¸æ‰‹æœº (ç±»ä¼¼iPhone 16)
                    panelWidth = 260; // ä¸iPhone 16ä¿æŒä¸€è‡´
                    maxCanvasSize = 370;
                }
                
                const availableWidth = windowWidth - panelWidth - CANVAS_MARGIN * 2;
                canvasSize = Math.min(availableHeight, availableWidth);
                canvasSize = Math.min(canvasSize, maxCanvasSize);
                
            } else {
                // æ ‡å‡†è®¾å¤‡ä½¿ç”¨åŸæœ‰é€»è¾‘
                const availableWidth = windowWidth - MIN_PANEL_WIDTH - CANVAS_MARGIN * 2;
                canvasSize = Math.min(availableHeight, availableWidth);
                panelWidth = MIN_PANEL_WIDTH;
                maxCanvasSize = MAX_CANVAS_SIZE;
            }

            // åº”ç”¨æœ€å°å€¼å’Œæœ€å¤§å€¼é™åˆ¶
            canvasSize = Math.max(MIN_CANVAS_SIZE, Math.min(canvasSize, maxCanvasSize));
            panelWidth = Math.max(MIN_PANEL_WIDTH, Math.min(panelWidth, MAX_PANEL_WIDTH));

            return {
                canvasSize,
                panelWidth,
                canvasMargin: CANVAS_MARGIN,
                safeAreaTop: SAFE_AREA_TOP,
                debug: {
                    windowSize: `${windowWidth}x${windowHeight}`,
                    availableHeight,
                    availableWidth: windowWidth - panelWidth - CANVAS_MARGIN * 2,
                    iPhone16Model: iPhone16Detection.model,
                    iPhone16Detected: iPhone16Detection.detected,
                    maxCanvasSize,
                    isHighResolutionLandscape: windowWidth >= 800 && windowHeight <= 460,
                    spaceUtilization: `ç”»å¸ƒ${canvasSize}px vs å¯ç”¨é«˜åº¦${availableHeight}px`,
                }
            };
        }

        function getDeviceLayoutMode(windowWidth, windowHeight) {
            const { DESKTOP_MIN_WIDTH, TABLET_MIN_WIDTH, DESKTOP_MOBILE_HEIGHT } = DEVICE_THRESHOLDS;

            const aspectRatio = Math.max(windowWidth, windowHeight) / Math.min(windowWidth, windowHeight);
            const isLongScreen = aspectRatio > 1.8;
            
            let isMobileUserAgent = false;
            if (typeof navigator !== 'undefined') {
                const ua = navigator.userAgent;
                isMobileUserAgent = /iPhone|iPad|iPod|Android|webOS|BlackBerry|IEMobile|Opera Mini/i.test(ua);
            }
            
            const isHighResolutionMobile = isLongScreen && (
                (windowWidth > 1000 && windowHeight > 2000) ||
                (windowHeight > 1000 && windowWidth > 2000)
            );
            
            const forceMobile = isMobileUserAgent || isHighResolutionMobile || windowHeight < DESKTOP_MOBILE_HEIGHT;
            
            if (forceMobile) {
                return {
                    deviceType: 'phone',
                    layoutMode: windowWidth > windowHeight ? 'landscape' : 'portrait',
                    forceReason: isMobileUserAgent ? 'user_agent' : 
                                isHighResolutionMobile ? 'high_resolution_mobile' : 
                                'height_threshold'
                };
            }

            if (windowWidth >= DESKTOP_MIN_WIDTH && !isLongScreen) {
                return {
                    deviceType: 'desktop',
                    layoutMode: 'desktop',
                };
            } else if (windowWidth >= TABLET_MIN_WIDTH && !isLongScreen) {
                return {
                    deviceType: 'tablet',
                    layoutMode: 'desktop',
                };
            } else {
                return {
                    deviceType: 'phone',
                    layoutMode: windowWidth > windowHeight ? 'landscape' : 'portrait',
                };
            }
        }

        function detectiPhone16Series(windowWidth, windowHeight) {
            // iPhone 16ç³»åˆ—é€»è¾‘åƒç´ å°ºå¯¸ï¼ˆ5ä¸ªæœºå‹ï¼‰
            const iPhone16Models = {
                'iPhone 16e': {
                    portrait: { width: 390, height: 844 },
                    landscape: { width: 844, height: 390 }
                },
                'iPhone 16': {
                    portrait: { width: 393, height: 852 },
                    landscape: { width: 852, height: 393 }
                },
                'iPhone 16 Plus': {
                    portrait: { width: 430, height: 932 },
                    landscape: { width: 932, height: 430 }
                },
                'iPhone 16 Pro': {
                    portrait: { width: 402, height: 874 },
                    landscape: { width: 874, height: 402 }
                },
                'iPhone 16 Pro Max': {
                    portrait: { width: 440, height: 956 },
                    landscape: { width: 956, height: 440 }
                }
            };

            // æ£€æµ‹å½“å‰è®¾å¤‡æ˜¯å¦åŒ¹é…iPhone 16ç³»åˆ—
            for (const [modelName, dimensions] of Object.entries(iPhone16Models)) {
                const { portrait, landscape } = dimensions;
                
                // ç²¾ç¡®åŒ¹é…
                if ((windowWidth === portrait.width && windowHeight === portrait.height) ||
                    (windowWidth === landscape.width && windowHeight === landscape.height)) {
                    return {
                        detected: true,
                        model: modelName,
                        orientation: windowWidth > windowHeight ? 'landscape' : 'portrait',
                        exact: true
                    };
                }
                
                // èŒƒå›´åŒ¹é…ï¼ˆå…è®¸Â±10pxçš„è¯¯å·®ï¼‰
                const tolerance = 10;
                const isPortraitRange = Math.abs(windowWidth - portrait.width) <= tolerance && 
                                       Math.abs(windowHeight - portrait.height) <= tolerance;
                const isLandscapeRange = Math.abs(windowWidth - landscape.width) <= tolerance && 
                                        Math.abs(windowHeight - landscape.height) <= tolerance;
                
                if (isPortraitRange || isLandscapeRange) {
                    return {
                        detected: true,
                        model: modelName,
                        orientation: windowWidth > windowHeight ? 'landscape' : 'portrait',
                        exact: false
                    };
                }
            }

            return {
                detected: false,
                model: null,
                orientation: null,
                exact: false
            };
        }

        function updateDisplay() {
            const windowWidth = window.innerWidth;
            const windowHeight = window.innerHeight;
            const deviceInfo = getDeviceLayoutMode(windowWidth, windowHeight);
            const iPhoneDetection = detectiPhone16Series(windowWidth, windowHeight);

            // æ›´æ–°è®¾å¤‡ä¿¡æ¯
            document.getElementById('window-size').textContent = `${windowWidth} Ã— ${windowHeight}`;
            document.getElementById('logical-pixels').textContent = `${windowWidth} Ã— ${windowHeight} (DPR: ${window.devicePixelRatio || 1})`;
            document.getElementById('device-type').textContent = deviceInfo.deviceType;
            document.getElementById('layout-mode').textContent = deviceInfo.layoutMode;
            
            // iPhone 16ç³»åˆ—æ£€æµ‹ç»“æœ
            const iPhoneIndicator = document.getElementById('iphone-indicator');
            const iPhoneDetectionSpan = document.getElementById('iphone-detection');
            
            if (iPhoneDetection.detected) {
                iPhoneIndicator.style.display = 'block';
                iPhoneIndicator.textContent = `ğŸ¯ æ£€æµ‹åˆ°${iPhoneDetection.model}ï¼`;
                iPhoneDetectionSpan.textContent = `âœ… ${iPhoneDetection.model} ${iPhoneDetection.orientation} (${iPhoneDetection.exact ? 'ç²¾ç¡®åŒ¹é…' : 'èŒƒå›´åŒ¹é…'})`;
                iPhoneDetectionSpan.style.color = '#4CAF50';
            } else {
                iPhoneIndicator.style.display = 'none';
                iPhoneDetectionSpan.textContent = 'âŒ æœªæ£€æµ‹åˆ°iPhone 16ç³»åˆ—';
                iPhoneDetectionSpan.style.color = '#f44336';
            }

            // ç”Ÿæˆå¸ƒå±€é¢„è§ˆ
            const preview = document.getElementById('canvas-preview');
            preview.innerHTML = '';

            let canvasSize, panelWidth, panelHeight;
            let debugInfo = {};

            if (deviceInfo.deviceType === 'phone') {
                if (deviceInfo.layoutMode === 'portrait') {
                    // ç«–å±å¸ƒå±€
                    preview.className = 'canvas-preview layout-portrait';
                    
                    const result = calculateMobilePortraitCanvasSize(windowWidth, windowHeight);
                    canvasSize = result.canvasSize;
                    panelHeight = MOBILE_ADAPTATION.PORTRAIT.PANEL_HEIGHT;

                    // åˆ›å»ºç”»å¸ƒæ¨¡æ‹Ÿ
                    const canvasMock = document.createElement('div');
                    canvasMock.className = 'canvas-mock';
                    canvasMock.style.width = canvasSize + 'px';
                    canvasMock.style.height = canvasSize + 'px';
                    canvasMock.textContent = `Canvas ${canvasSize}Ã—${canvasSize}`;

                    // åˆ›å»ºé¢æ¿æ¨¡æ‹Ÿ
                    const panelMock = document.createElement('div');
                    panelMock.className = 'panel-mock';
                    panelMock.style.width = canvasSize + 'px';
                    panelMock.style.height = panelHeight + 'px';
                    panelMock.textContent = `Panel ${canvasSize}Ã—${panelHeight}`;

                    preview.appendChild(canvasMock);
                    preview.appendChild(panelMock);

                    debugInfo = result.debug;
                } else {
                    // æ¨ªå±å¸ƒå±€
                    preview.className = 'canvas-preview layout-landscape';
                    
                    const result = calculateMobileLandscapeCanvasSize(windowWidth, windowHeight);
                    canvasSize = result.canvasSize;
                    panelWidth = result.panelWidth;

                    // åˆ›å»ºé¢æ¿æ¨¡æ‹Ÿ
                    const panelMock = document.createElement('div');
                    panelMock.className = 'panel-mock';
                    panelMock.style.width = panelWidth + 'px';
                    panelMock.style.height = canvasSize + 'px';
                    panelMock.textContent = `Panel ${panelWidth}Ã—${canvasSize}`;

                    // åˆ›å»ºç”»å¸ƒæ¨¡æ‹Ÿ
                    const canvasMock = document.createElement('div');
                    canvasMock.className = 'canvas-mock';
                    canvasMock.style.width = canvasSize + 'px';
                    canvasMock.style.height = canvasSize + 'px';
                    canvasMock.textContent = `Canvas ${canvasSize}Ã—${canvasSize}`;

                    preview.appendChild(panelMock);
                    preview.appendChild(canvasMock);

                    debugInfo = result.debug;
                }
            } else {
                // æ¡Œé¢å¸ƒå±€
                preview.innerHTML = '<div class="info-text">æ¡Œé¢å¸ƒå±€ - ä½¿ç”¨å›ºå®šé¢æ¿å®½åº¦å’Œå“åº”å¼ç”»å¸ƒ</div>';
                debugInfo = { message: 'æ¡Œé¢å¸ƒå±€ä¸åœ¨æ­¤æµ‹è¯•èŒƒå›´å†…' };
            }

            // æ›´æ–°è°ƒè¯•ä¿¡æ¯
            const debugElement = document.getElementById('debug-info');
            debugElement.innerHTML = `
                <strong>è°ƒè¯•ä¿¡æ¯:</strong><br>
                è®¾å¤‡æ£€æµ‹: ${JSON.stringify(deviceInfo, null, 2)}<br>
                iPhone 16 Proæ£€æµ‹: ${JSON.stringify(iPhoneDetection, null, 2)}<br>
                å¸ƒå±€è®¡ç®—: ${JSON.stringify(debugInfo, null, 2)}
            `;
        }

        // åˆå§‹åŒ–å’Œç›‘å¬çª—å£å˜åŒ–
        updateDisplay();
        window.addEventListener('resize', updateDisplay);
        window.addEventListener('orientationchange', () => {
            setTimeout(updateDisplay, 300);
        });
    </script>
</body>
</html>