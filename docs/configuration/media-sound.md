# åª’ä½“èµ„æºä¸éŸ³æ•ˆé…ç½®

> ä¿®è®¢æ—¥æœŸï¼š2025-07-24 (v1.3.36)

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜åª’ä½“èµ„æºå’ŒéŸ³æ•ˆç³»ç»Ÿçš„é…ç½®å‚æ•°ï¼ŒåŒ…æ‹¬èƒŒæ™¯éŸ³ä¹ã€äº¤äº’éŸ³æ•ˆã€é™æ€èµ„æºç­‰æ ¸å¿ƒé…ç½®ã€‚

---

## 1. èƒŒæ™¯éŸ³ä¹é…ç½®

### backgroundMusic
- **ä½œç”¨**ï¼šèƒŒæ™¯éŸ³ä¹å¼€å…³ä¸éŸ³é‡æ§åˆ¶
- **å–å€¼èŒƒå›´**ï¼šå¸ƒå°”ï¼ˆå¼€å…³ï¼‰+ 0~1ï¼ˆéŸ³é‡ï¼‰
- **é»˜è®¤å€¼**ï¼šfalseï¼ˆé™éŸ³ï¼‰ï¼Œ0.3ï¼ˆéŸ³é‡ï¼‰
- **å½±å“ç‚¹**ï¼šç”¨æˆ·ä½“éªŒã€æ²‰æµ¸æ„Ÿ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ã€`components/GlobalUtilityButtons.tsx`

### musicToggleButton
- **ä½œç”¨**ï¼šéŸ³ä¹å¼€å…³æŒ‰é’®é…ç½®
- **æŒ‰é’®æ ·å¼**ï¼š24pxå›¾æ ‡ï¼Œç»Ÿä¸€é£æ ¼
- **çŠ¶æ€æ˜¾ç¤º**ï¼šéŸ³ä¹å¼€å¯/å…³é—­çŠ¶æ€å›¾æ ‡åˆ‡æ¢
- **é»˜è®¤å€¼**ï¼šå…³é—­çŠ¶æ€
- **å½±å“ç‚¹**ï¼šç”¨æˆ·æ§åˆ¶ä¾¿åˆ©æ€§
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`components/GlobalUtilityButtons.tsx`

### audioContext
- **ä½œç”¨**ï¼šWeb Audio APIä¸Šä¸‹æ–‡é…ç½®
- **åˆ›å»ºç­–ç•¥**ï¼šç”¨æˆ·é¦–æ¬¡äº¤äº’ååˆ›å»º
- **é»˜è®¤å€¼**ï¼šå»¶è¿Ÿåˆ›å»º
- **å½±å“ç‚¹**ï¼šéŸ³é¢‘æ’­æ”¾å…¼å®¹æ€§
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`

---

## 2. äº¤äº’éŸ³æ•ˆé…ç½®

### pieceSelectSound
- **ä½œç”¨**ï¼šæ‹¼å›¾å—é€‰ä¸­éŸ³æ•ˆ
- **éŸ³é¢‘å‚æ•°**ï¼š
  - é¢‘ç‡ï¼š660Hz
  - æŒç»­æ—¶é—´ï¼š0.15s
  - æ³¢å½¢ï¼šæ­£å¼¦æ³¢
  - éŸ³é‡ï¼š0.3
- **é»˜è®¤å€¼**ï¼šå¦‚ä¸Šæ‰€ç¤º
- **å½±å“ç‚¹**ï¼šäº¤äº’åé¦ˆ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆplayPieceSelectSoundå‡½æ•°ï¼‰

### pieceSnapSound
- **ä½œç”¨**ï¼šæ‹¼å›¾å—å¸é™„éŸ³æ•ˆ
- **éŸ³é¢‘å‚æ•°**ï¼š
  - é¢‘ç‡ï¼š1320Hz
  - æŒç»­æ—¶é—´ï¼š0.3s
  - æ³¢å½¢ï¼šæ­£å¼¦æ³¢
  - éŸ³é‡ï¼š0.4
- **é»˜è®¤å€¼**ï¼šå¦‚ä¸Šæ‰€ç¤º
- **å½±å“ç‚¹**ï¼šæˆåŠŸåé¦ˆ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆplayPieceSnapSoundå‡½æ•°ï¼‰

### rotateSound
- **ä½œç”¨**ï¼šæ‹¼å›¾å—æ—‹è½¬éŸ³æ•ˆ
- **éŸ³é¢‘å‚æ•°**ï¼š
  - é¢‘ç‡ï¼š380Hz
  - æŒç»­æ—¶é—´ï¼š0.12s
  - æ³¢å½¢ï¼šæ­£å¼¦æ³¢
  - éŸ³é‡ï¼š0.25
- **é»˜è®¤å€¼**ï¼šå¦‚ä¸Šæ‰€ç¤º
- **å½±å“ç‚¹**ï¼šæ“ä½œåé¦ˆ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆplayRotateSoundå‡½æ•°ï¼‰

### collisionSound
- **ä½œç”¨**ï¼šè¾¹ç•Œç¢°æ’éŸ³æ•ˆï¼ˆåŒéŸ³è°ƒï¼‰
- **éŸ³é¢‘å‚æ•°**ï¼š
  - ä½éŸ³ï¼š120Hzï¼ŒæŒç»­0.15s
  - é«˜éŸ³ï¼š240Hzï¼ŒæŒç»­0.1s
  - æ³¢å½¢ï¼šæ­£å¼¦æ³¢
  - éŸ³é‡ï¼š0.2
- **é»˜è®¤å€¼**ï¼šå¦‚ä¸Šæ‰€ç¤º
- **å½±å“ç‚¹**ï¼šè¾¹ç•Œåé¦ˆ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`contexts/GameContext.tsx`ï¼ˆè¾¹ç•Œæ£€æµ‹é€»è¾‘ï¼‰

---

## 3. å®Œæˆåº†ç¥éŸ³æ•ˆé…ç½®

### puzzleCompletedSound
- **ä½œç”¨**ï¼šæ‹¼å›¾å®ŒæˆéŸ³æ•ˆï¼ˆéŸ³é˜¶åºåˆ—ï¼‰
- **éŸ³é˜¶é…ç½®**ï¼š
  - C5ï¼š523.25Hz
  - E5ï¼š659.25Hz
  - G5ï¼š783.99Hz
  - C6ï¼š1046.5Hz
- **æ’­æ”¾å‚æ•°**ï¼š
  - é—´éš”ï¼š0.1s
  - æŒç»­æ—¶é—´ï¼šæ¯ä¸ªéŸ³ç¬¦0.4s
  - éŸ³é‡ï¼š0.5
- **é»˜è®¤å€¼**ï¼šå¦‚ä¸Šæ‰€ç¤º
- **å½±å“ç‚¹**ï¼šå®Œæˆåº†ç¥ä½“éªŒ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆplayPuzzleCompletedSoundå‡½æ•°ï¼‰

### celebrationSequence
- **ä½œç”¨**ï¼šåº†ç¥éŸ³æ•ˆæ’­æ”¾åºåˆ—é…ç½®
- **æ’­æ”¾ç­–ç•¥**ï¼šä¾æ¬¡æ’­æ”¾éŸ³é˜¶ï¼Œåˆ›é€ ä¸Šå‡æ„Ÿ
- **é”™è¯¯å¤„ç†**ï¼šå•ä¸ªéŸ³ç¬¦å¤±è´¥ä¸å½±å“æ•´ä½“åºåˆ—
- **é»˜è®¤å€¼**ï¼šå¯ç”¨å®Œæ•´åºåˆ—
- **å½±å“ç‚¹**ï¼šåº†ç¥æ•ˆæœçš„å®Œæ•´æ€§
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆéŸ³é˜¶æ’­æ”¾é€»è¾‘ï¼‰

---

## 4. é™æ€èµ„æºé…ç½®

### backgroundImage
- **ä½œç”¨**ï¼šæ¸¸æˆèƒŒæ™¯å›¾ç‰‡é…ç½®
- **æ–‡ä»¶è·¯å¾„**ï¼š`public/bg.jpg`
- **å›¾ç‰‡è§„æ ¼**ï¼šé«˜åˆ†è¾¨ç‡ï¼Œæ”¯æŒå¤šç§å±å¹•å°ºå¯¸
- **åŠ è½½ç­–ç•¥**ï¼šé¢„åŠ è½½ï¼Œç¼“å­˜ä¼˜åŒ–
- **é»˜è®¤å€¼**ï¼šå¯ç”¨èƒŒæ™¯å›¾ç‰‡
- **å½±å“ç‚¹**ï¼šè§†è§‰ä½“éªŒã€åŠ è½½æ€§èƒ½
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`public/bg.jpg`ã€CSSèƒŒæ™¯é…ç½®

### audioFile
- **ä½œç”¨**ï¼šæ¸¸æˆéŸ³æ•ˆæ–‡ä»¶é…ç½®
- **æ–‡ä»¶è·¯å¾„**ï¼š`public/puzzle-pieces.mp3`
- **æ–‡ä»¶æ ¼å¼**ï¼šMP3æ ¼å¼ï¼Œå…¼å®¹æ€§å¥½
- **æ–‡ä»¶å¤§å°**ï¼šä¼˜åŒ–å‹ç¼©ï¼Œå¹³è¡¡è´¨é‡å’Œå¤§å°
- **é»˜è®¤å€¼**ï¼šå¯ç”¨éŸ³æ•ˆæ–‡ä»¶
- **å½±å“ç‚¹**ï¼šéŸ³æ•ˆè´¨é‡ã€åŠ è½½é€Ÿåº¦
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`public/puzzle-pieces.mp3`

### textureFile
- **ä½œç”¨**ï¼šç“·ç –æ°”å­”æè´¨çº¹ç†é…ç½®
- **æ–‡ä»¶è·¯å¾„**ï¼š`public/texture-tile.png`
- **ç”¨é€”**ï¼šæ‹¼å›¾å—å’Œç›®æ ‡å½¢çŠ¶çš„ç¾æœ¯å¡«å……
- **å›¾ç‰‡è§„æ ¼**ï¼šPNGæ ¼å¼ï¼Œæ”¯æŒé€æ˜åº¦
- **é»˜è®¤å€¼**ï¼šå¯ç”¨æè´¨çº¹ç†
- **å½±å“ç‚¹**ï¼šè§†è§‰è´¨æ„Ÿã€ç¾æœ¯æ•ˆæœ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`public/texture-tile.png`ã€`utils/rendering/puzzleDrawing.ts`

---

## 5. éŸ³æ•ˆæ’­æ”¾æ§åˆ¶é…ç½®

### soundEnabled
- **ä½œç”¨**ï¼šå…¨å±€éŸ³æ•ˆå¼€å…³é…ç½®
- **æ§åˆ¶èŒƒå›´**ï¼šæ‰€æœ‰äº¤äº’éŸ³æ•ˆå’ŒèƒŒæ™¯éŸ³ä¹
- **å­˜å‚¨æ–¹å¼**ï¼šæœ¬åœ°å­˜å‚¨ï¼Œè®°ä½ç”¨æˆ·åå¥½
- **é»˜è®¤å€¼**ï¼šfalseï¼ˆé»˜è®¤é™éŸ³ï¼‰
- **å½±å“ç‚¹**ï¼šç”¨æˆ·ä½“éªŒã€æ€§èƒ½ä¼˜åŒ–
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆå…¨å±€å¼€å…³ï¼‰

### volumeControl
- **ä½œç”¨**ï¼šéŸ³é‡æ§åˆ¶é…ç½®
- **éŸ³é‡èŒƒå›´**ï¼š0.0~1.0
- **éŸ³é‡åˆ†çº§**ï¼š
  - èƒŒæ™¯éŸ³ä¹ï¼š0.3
  - äº¤äº’éŸ³æ•ˆï¼š0.2~0.5
  - åº†ç¥éŸ³æ•ˆï¼š0.5
- **é»˜è®¤å€¼**ï¼šåˆ†çº§éŸ³é‡è®¾ç½®
- **å½±å“ç‚¹**ï¼šéŸ³æ•ˆå¹³è¡¡ã€ç”¨æˆ·ä½“éªŒ
- **é…ç½®/ä»£ç ä½ç½®**ï¼šå„éŸ³æ•ˆå‡½æ•°çš„éŸ³é‡å‚æ•°

### audioContextManagement
- **ä½œç”¨**ï¼šéŸ³é¢‘ä¸Šä¸‹æ–‡ç®¡ç†é…ç½®
- **åˆ›å»ºæ—¶æœº**ï¼šç”¨æˆ·é¦–æ¬¡äº¤äº’å
- **ç”Ÿå‘½å‘¨æœŸ**ï¼šé¡µé¢ä¼šè¯æœŸé—´ä¿æŒ
- **é”™è¯¯å¤„ç†**ï¼šåˆ›å»ºå¤±è´¥æ—¶çš„é™çº§å¤„ç†
- **é»˜è®¤å€¼**ï¼šè‡ªåŠ¨ç®¡ç†
- **å½±å“ç‚¹**ï¼šéŸ³é¢‘æ’­æ”¾ç¨³å®šæ€§
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆä¸Šä¸‹æ–‡ç®¡ç†ï¼‰

---

## 6. è®¾å¤‡é€‚é…é…ç½®

### mobileAudioOptimization
- **ä½œç”¨**ï¼šç§»åŠ¨ç«¯éŸ³é¢‘ä¼˜åŒ–é…ç½®
- **ä¼˜åŒ–ç­–ç•¥**ï¼š
  - å‡å°‘åŒæ—¶æ’­æ”¾çš„éŸ³æ•ˆæ•°é‡
  - ä¼˜åŒ–éŸ³é¢‘æ–‡ä»¶å¤§å°
  - å¤„ç†ç§»åŠ¨ç«¯éŸ³é¢‘é™åˆ¶
- **é»˜è®¤å€¼**ï¼šç§»åŠ¨ç«¯å¯ç”¨ä¼˜åŒ–
- **å½±å“ç‚¹**ï¼šç§»åŠ¨ç«¯éŸ³æ•ˆä½“éªŒ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆè®¾å¤‡æ£€æµ‹é€»è¾‘ï¼‰

### touchAudioUnlock
- **ä½œç”¨**ï¼šç§»åŠ¨ç«¯è§¦æ‘¸è§£é”éŸ³é¢‘é…ç½®
- **è§£é”ç­–ç•¥**ï¼šé¦–æ¬¡è§¦æ‘¸äº¤äº’æ—¶è§£é”éŸ³é¢‘æ’­æ”¾
- **å…¼å®¹æ€§å¤„ç†**ï¼šå¤„ç†iOS Safariç­‰æµè§ˆå™¨é™åˆ¶
- **é»˜è®¤å€¼**ï¼šç§»åŠ¨ç«¯å¯ç”¨
- **å½±å“ç‚¹**ï¼šç§»åŠ¨ç«¯éŸ³é¢‘æ’­æ”¾èƒ½åŠ›
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆè§¦æ‘¸è§£é”é€»è¾‘ï¼‰

---

## 7. æ€§èƒ½ä¼˜åŒ–é…ç½®

### audioPreloading
- **ä½œç”¨**ï¼šéŸ³é¢‘é¢„åŠ è½½é…ç½®
- **é¢„åŠ è½½ç­–ç•¥**ï¼šé¡µé¢åŠ è½½æ—¶é¢„åˆ›å»ºéŸ³é¢‘ä¸Šä¸‹æ–‡
- **ç¼“å­˜æœºåˆ¶**ï¼šéŸ³é¢‘ç¼“å†²åŒºå¤ç”¨
- **é»˜è®¤å€¼**ï¼šå¯ç”¨é¢„åŠ è½½
- **å½±å“ç‚¹**ï¼šéŸ³æ•ˆå“åº”é€Ÿåº¦
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆé¢„åŠ è½½é€»è¾‘ï¼‰

### audioMemoryManagement
- **ä½œç”¨**ï¼šéŸ³é¢‘å†…å­˜ç®¡ç†é…ç½®
- **ç®¡ç†ç­–ç•¥**ï¼š
  - åŠæ—¶é‡Šæ”¾ä¸ç”¨çš„éŸ³é¢‘èµ„æº
  - é™åˆ¶åŒæ—¶æ’­æ”¾çš„éŸ³æ•ˆæ•°é‡
  - é¿å…éŸ³é¢‘å†…å­˜æ³„æ¼
- **é»˜è®¤å€¼**ï¼šå¯ç”¨å†…å­˜ç®¡ç†
- **å½±å“ç‚¹**ï¼šé•¿æœŸä½¿ç”¨çš„å†…å­˜ç¨³å®šæ€§
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆå†…å­˜ç®¡ç†ï¼‰

### audioPerformanceMonitoring
- **ä½œç”¨**ï¼šéŸ³é¢‘æ€§èƒ½ç›‘æ§é…ç½®
- **ç›‘æ§æŒ‡æ ‡**ï¼š
  - éŸ³æ•ˆæ’­æ”¾å»¶è¿Ÿ
  - éŸ³é¢‘ä¸Šä¸‹æ–‡çŠ¶æ€
  - å†…å­˜ä½¿ç”¨æƒ…å†µ
- **é»˜è®¤å€¼**ï¼šå¼€å‘ç¯å¢ƒå¯ç”¨
- **å½±å“ç‚¹**ï¼šéŸ³æ•ˆæ€§èƒ½ä¼˜åŒ–
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆæ€§èƒ½ç›‘æ§ï¼‰

---

## 8. é”™è¯¯å¤„ç†é…ç½®

### audioErrorHandling
- **ä½œç”¨**ï¼šéŸ³é¢‘é”™è¯¯å¤„ç†é…ç½®
- **é”™è¯¯ç±»å‹**ï¼š
  - éŸ³é¢‘ä¸Šä¸‹æ–‡åˆ›å»ºå¤±è´¥
  - éŸ³æ•ˆæ’­æ”¾å¤±è´¥
  - æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜
- **å¤„ç†ç­–ç•¥**ï¼šé™é»˜å¤±è´¥ï¼Œä¸å½±å“æ¸¸æˆåŠŸèƒ½
- **é»˜è®¤å€¼**ï¼šå¯ç”¨é”™è¯¯å¤„ç†
- **å½±å“ç‚¹**ï¼šç³»ç»Ÿç¨³å®šæ€§
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆtry-catchå¤„ç†ï¼‰

### fallbackStrategy
- **ä½œç”¨**ï¼šéŸ³é¢‘é™çº§ç­–ç•¥é…ç½®
- **é™çº§æ–¹æ¡ˆ**ï¼š
  - éŸ³é¢‘ä¸æ”¯æŒæ—¶ç¦ç”¨éŸ³æ•ˆ
  - éƒ¨åˆ†éŸ³æ•ˆå¤±è´¥æ—¶ç»§ç»­å…¶ä»–éŸ³æ•ˆ
  - æä¾›è§†è§‰åé¦ˆæ›¿ä»£éŸ³æ•ˆ
- **é»˜è®¤å€¼**ï¼šå¯ç”¨é™çº§ç­–ç•¥
- **å½±å“ç‚¹**ï¼šå…¼å®¹æ€§å’Œç”¨æˆ·ä½“éªŒ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/rendering/soundEffects.ts`ï¼ˆé™çº§é€»è¾‘ï¼‰

---

## 9. é…ç½®ç¤ºä¾‹

### åŸºç¡€éŸ³æ•ˆé…ç½®ç¤ºä¾‹
```typescript
// éŸ³æ•ˆé…ç½®ç¤ºä¾‹
const soundConfig = {
  enabled: false,
  volume: {
    background: 0.3,
    interaction: 0.3,
    celebration: 0.5
  },
  frequencies: {
    select: 660,
    snap: 1320,
    rotate: 380,
    collision: [120, 240]
  }
};
```

### é«˜çº§éŸ³æ•ˆé…ç½®ç¤ºä¾‹
```typescript
// è®¾å¤‡é€‚é…éŸ³æ•ˆé…ç½®
const deviceAudioConfig = {
  mobile: {
    maxConcurrentSounds: 2,
    touchUnlock: true,
    optimizedFiles: true
  },
  desktop: {
    maxConcurrentSounds: 5,
    preloading: true,
    fullQuality: true
  }
};
```

---

## 10. æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **éŸ³æ•ˆæ— æ³•æ’­æ”¾**ï¼šæ£€æŸ¥éŸ³é¢‘ä¸Šä¸‹æ–‡æ˜¯å¦å·²åˆ›å»º
2. **ç§»åŠ¨ç«¯é™éŸ³**ï¼šç¡®è®¤è§¦æ‘¸è§£é”å·²è§¦å‘
3. **éŸ³æ•ˆå»¶è¿Ÿ**ï¼šæ£€æŸ¥éŸ³é¢‘é¢„åŠ è½½é…ç½®
4. **å†…å­˜æ³„æ¼**ï¼šéªŒè¯éŸ³é¢‘èµ„æºé‡Šæ”¾é€»è¾‘

### è°ƒè¯•æ–¹æ³•
- æ£€æŸ¥éŸ³é¢‘ä¸Šä¸‹æ–‡çŠ¶æ€
- ç›‘æ§éŸ³æ•ˆæ’­æ”¾æ—¥å¿—
- éªŒè¯ç”¨æˆ·äº¤äº’è§¦å‘
- æµ‹è¯•ä¸åŒè®¾å¤‡å…¼å®¹æ€§

---

> ğŸ“– **ç›¸å…³æ–‡æ¡£**
> - [è§†è§‰ä¸ä¸»é¢˜é…ç½®](./14-visual-theme.md)
> - [è§¦æ‘¸äº‹ä»¶ä¸äº¤äº’é…ç½®](./18-touch-interaction.md)
> - [æ€§èƒ½æµ‹è¯•ä¸æŠ¥å‘Šé…ç½®](./16-performance-test.md)