# è®¾å¤‡é€‚é…ä¸å“åº”å¼é…ç½®

> ä¿®è®¢æ—¥æœŸï¼š2025-01-24 (v1.3.36)

æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜è®¾å¤‡é€‚é…å’Œå“åº”å¼ç³»ç»Ÿçš„é…ç½®å‚æ•°ï¼ŒåŒ…æ‹¬è®¾å¤‡æ£€æµ‹ã€ç”»å¸ƒé€‚é…ã€å“åº”å¼å¸ƒå±€ç­‰æ ¸å¿ƒé…ç½®ã€‚

---

## 1. ç»Ÿä¸€è®¾å¤‡æ£€æµ‹é…ç½®ï¼ˆv1.3.33é‡æ„ï¼Œv1.3.34å¢å¼ºï¼‰

### useDevice Hooké…ç½®
- **ä½œç”¨**ï¼šç»Ÿä¸€è®¾å¤‡æ£€æµ‹Hookï¼Œæ›¿ä»£åˆ†æ•£çš„è®¾å¤‡æ£€æµ‹é€»è¾‘
- **è¿”å›å€¼**ï¼š`{ isMobile: boolean, isPortrait: boolean, deviceType: string, screenWidth: number, screenHeight: number }`
- **é»˜è®¤å€¼**ï¼šè‡ªåŠ¨æ£€æµ‹
- **å½±å“ç‚¹**ï¼šæ‰€æœ‰ç»„ä»¶çš„è®¾å¤‡æ£€æµ‹é€»è¾‘
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`hooks/useDevice.ts`ã€`utils/core/DeviceManager.ts`

### deviceDetectionPriorityï¼ˆv1.3.34æ–°å¢ï¼‰
- **ä½œç”¨**ï¼šè®¾å¤‡æ£€æµ‹ä¼˜å…ˆçº§é¡ºåºï¼Œç¡®ä¿ç§»åŠ¨è®¾å¤‡å‡†ç¡®è¯†åˆ«
- **ä¼˜å…ˆçº§é¡ºåº**ï¼š
  1. ç”¨æˆ·ä»£ç†æ£€æµ‹ (isIOS || isAndroid) - æœ€é«˜ä¼˜å…ˆçº§
  2. iPhone 16ç³»åˆ—ç²¾ç¡®æ£€æµ‹ - ç‰¹æ®Šä¼˜åŒ–
  3. è§¦æ‘¸è®¾å¤‡æ£€æµ‹ - ç»¼åˆåˆ¤æ–­
  4. ä¼ ç»Ÿå±å¹•å°ºå¯¸æ£€æµ‹ - å…œåº•æ–¹æ¡ˆ
- **é»˜è®¤å€¼**ï¼šæŒ‰ä¼˜å…ˆçº§é¡ºåºæ‰§è¡Œ
- **å½±å“ç‚¹**ï¼šè®¾å¤‡ç±»å‹åˆ¤æ–­å‡†ç¡®æ€§ï¼Œé¿å…ç§»åŠ¨è®¾å¤‡è¢«è¯¯è¯†åˆ«ä¸ºæ¡Œé¢ç«¯
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/core/DeviceManager.ts`

### userAgentDetectionï¼ˆv1.3.34å¢å¼ºï¼‰
- **ä½œç”¨**ï¼šä¼˜å…ˆä½¿ç”¨ç”¨æˆ·ä»£ç†æ£€æµ‹ç§»åŠ¨è®¾å¤‡ï¼Œæœ€é«˜ä¼˜å…ˆçº§
- **æ£€æµ‹é€»è¾‘**ï¼š`isIOS || isAndroid`
- **é»˜è®¤å€¼**ï¼šå¯ç”¨
- **å½±å“ç‚¹**ï¼šæ¨ªå±åˆ·æ–°æ—¶æ­£ç¡®è¯†åˆ«ç§»åŠ¨è®¾å¤‡
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/core/DeviceManager.ts`ï¼ˆdetectDeviceæ–¹æ³•ï¼‰

### touchDeviceDetectionï¼ˆv1.3.34æ–°å¢ï¼‰
- **ä½œç”¨**ï¼šè§¦æ‘¸è®¾å¤‡æ£€æµ‹å¢å¼ºï¼Œè¾…åŠ©ç§»åŠ¨è®¾å¤‡è¯†åˆ«
- **æ£€æµ‹é€»è¾‘**ï¼š`'ontouchstart' in window || navigator.maxTouchPoints > 0`
- **é»˜è®¤å€¼**ï¼šå¯ç”¨
- **å½±å“ç‚¹**ï¼šç»¼åˆè®¾å¤‡æ£€æµ‹å‡†ç¡®æ€§
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/core/DeviceManager.ts`

---

## 2. iPhone 16ç³»åˆ—ç²¾ç¡®é€‚é…é…ç½®ï¼ˆv1.3.34æ–°å¢ï¼‰

### iPhone16SeriesDetection
- **ä½œç”¨**ï¼šiPhone 16å…¨ç³»åˆ—ç²¾ç¡®æ£€æµ‹å’Œä¼˜åŒ–
- **æ”¯æŒæœºå‹**ï¼š
  - iPhone 16e: 390Ã—844 / 844Ã—390
  - iPhone 16: 393Ã—852 / 852Ã—393
  - iPhone 16 Plus: 430Ã—932 / 932Ã—430
  - iPhone 16 Pro: 402Ã—874 / 874Ã—402
  - iPhone 16 Pro Max: 440Ã—956 / 956Ã—440
- **é»˜è®¤å€¼**ï¼šå¯ç”¨ç²¾ç¡®æ£€æµ‹
- **å½±å“ç‚¹**ï¼šiPhone 16ç³»åˆ—çš„ç”»å¸ƒå°ºå¯¸å’Œé¢æ¿å®½åº¦ä¼˜åŒ–
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`constants/canvasAdaptation.ts`ï¼ˆdetectiPhone16Serieså‡½æ•°ï¼‰

### iPhone16CanvasOptimization
- **ä½œç”¨**ï¼šiPhone 16ç³»åˆ—ç”»å¸ƒå°ºå¯¸é’ˆå¯¹æ€§ä¼˜åŒ–
- **ä¼˜åŒ–å‚æ•°**ï¼š
  - iPhone 16 Pro Max: maxCanvasSize = 420px
  - iPhone 16 Plus: maxCanvasSize = 410px
  - iPhone 16 Pro: maxCanvasSize = 380px
  - iPhone 16: maxCanvasSize = 360px
  - iPhone 16e: maxCanvasSize = 350px
- **é»˜è®¤å€¼**ï¼šæŒ‰æœºå‹è‡ªåŠ¨ä¼˜åŒ–
- **å½±å“ç‚¹**ï¼šç”»å¸ƒæ˜¾ç¤ºæ•ˆæœå’Œç©ºé—´åˆ©ç”¨ç‡
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`constants/canvasAdaptation.ts`

---

## 3. ç»Ÿä¸€ç”»å¸ƒç®¡ç†é…ç½®ï¼ˆv1.3.33é‡æ„ï¼Œv1.3.34ä¼˜åŒ–ï¼‰

### useCanvas Hooké…ç½®
- **ä½œç”¨**ï¼šç»Ÿä¸€ç”»å¸ƒç®¡ç†Hookï¼Œæ›¿ä»£åˆ†æ•£çš„ç”»å¸ƒçŠ¶æ€ç®¡ç†
- **è¿”å›å€¼**ï¼š`{ canvasSize: CanvasSize, scale: number, updateCanvas: Function }`
- **é»˜è®¤å€¼**ï¼šè‡ªåŠ¨åˆå§‹åŒ–
- **å½±å“ç‚¹**ï¼šæ‰€æœ‰å¸ƒå±€ç»„ä»¶çš„ç”»å¸ƒç®¡ç†
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`hooks/useCanvas.ts`ã€`utils/core/CanvasManager.ts`

### mobileCanvasStrategyï¼ˆv1.3.34æ–°å¢ï¼‰
- **ä½œç”¨**ï¼šç§»åŠ¨ç«¯ç”»å¸ƒç®¡ç†ç­–ç•¥ï¼Œè®©å¸ƒå±€ç»„ä»¶æ§åˆ¶ç”»å¸ƒå¤§å°
- **ç­–ç•¥é€‰æ‹©**ï¼š
  - ç§»åŠ¨ç«¯ï¼š'container-based'ï¼ˆä½¿ç”¨å®¹å™¨å®é™…å°ºå¯¸ï¼‰
  - æ¡Œé¢ç«¯ï¼š'dynamic-calculation'ï¼ˆä½¿ç”¨åŠ¨æ€è®¡ç®—ï¼‰
- **é»˜è®¤å€¼**ï¼šæ ¹æ®è®¾å¤‡ç±»å‹è‡ªåŠ¨é€‰æ‹©
- **å½±å“ç‚¹**ï¼šç§»åŠ¨ç«¯ç”»å¸ƒå°ºå¯¸æ§åˆ¶æƒäº¤ç»™å¸ƒå±€ç»„ä»¶
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`hooks/useCanvas.ts`

### canvasSizeCalculationModeï¼ˆv1.3.34ä¿®å¤ï¼‰
- **ä½œç”¨**ï¼šç”»å¸ƒå°ºå¯¸è®¡ç®—æ¨¡å¼é€‰æ‹©
- **æ¨¡å¼é€‰æ‹©**ï¼š
  - 'layout-component-direct'ï¼šå¸ƒå±€ç»„ä»¶ç›´æ¥è®¡ç®—
  - 'useCanvas-return'ï¼šä½¿ç”¨useCanvasè¿”å›å€¼
- **é»˜è®¤å€¼**ï¼š'layout-component-direct'
- **å½±å“ç‚¹**ï¼šè§£å†³ç«–å±å¤§ç¼©å°åŠ¨æ€æ˜¾ç¤ºé—®é¢˜
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`components/layouts/PhonePortraitLayout.tsx`, `components/layouts/PhoneLandscapeLayout.tsx`

---

## 4. ç§»åŠ¨ç«¯ç”»å¸ƒå°ºå¯¸è®¡ç®—é…ç½®ï¼ˆv1.3.34æ–°å¢ï¼‰

### portraitCanvasCalculation
- **ä½œç”¨**ï¼šç«–å±æ¨¡å¼ç”»å¸ƒå°ºå¯¸è®¡ç®—ç­–ç•¥
- **è®¡ç®—å…¬å¼**ï¼š`Math.min(screenWidth - CANVAS_MARGIN * 2, screenHeight - PANEL_HEIGHT - SAFE_AREAS)`
- **å–å€¼èŒƒå›´**ï¼š240px ~ 420pxï¼ˆæ ¹æ®è®¾å¤‡åŠ¨æ€è°ƒæ•´ï¼‰
- **é»˜è®¤å€¼**ï¼šåŠ¨æ€è®¡ç®—
- **å½±å“ç‚¹**ï¼šç«–å±ç”»å¸ƒæŒ‰å±å¹•å®½åº¦é€‚é…ï¼Œä¿æŒæ­£æ–¹å½¢
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`constants/canvasAdaptation.ts`ï¼ˆcalculateMobilePortraitCanvasSizeå‡½æ•°ï¼‰

### landscapeCanvasCalculation
- **ä½œç”¨**ï¼šæ¨ªå±æ¨¡å¼ç”»å¸ƒå°ºå¯¸è®¡ç®—ç­–ç•¥
- **è®¡ç®—å…¬å¼**ï¼š`Math.min(screenHeight - CANVAS_MARGIN * 2 - SAFE_AREA_TOP, maxCanvasSize)`
- **å–å€¼èŒƒå›´**ï¼š240px ~ 420pxï¼ˆæ ¹æ®è®¾å¤‡åŠ¨æ€è°ƒæ•´ï¼‰
- **é»˜è®¤å€¼**ï¼šåŠ¨æ€è®¡ç®—
- **å½±å“ç‚¹**ï¼šæ¨ªå±ç”»å¸ƒæŒ‰å±å¹•é«˜åº¦é€‚é…ï¼Œä¿æŒæ­£æ–¹å½¢
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`constants/canvasAdaptation.ts`ï¼ˆcalculateMobileLandscapeCanvasSizeå‡½æ•°ï¼‰

### landscapePanelWidthStrategyï¼ˆv1.3.34æ–°å¢ï¼‰
- **ä½œç”¨**ï¼šæ¨ªå±æ¨¡å¼é¢æ¿å®½åº¦æ™ºèƒ½è®¡ç®—ç­–ç•¥
- **è®¡ç®—é€»è¾‘**ï¼šä¼˜å…ˆä½¿ç”¨ç”»å¸ƒå°ºå¯¸ä½œä¸ºé¢æ¿å®½åº¦ï¼Œç©ºé—´ä¸å¤Ÿåˆ™é™çº§ä½¿ç”¨åŸå§‹è®¡ç®—å®½åº¦
- **å–å€¼èŒƒå›´**ï¼šidealPanelWidth = canvasSizeValueï¼Œfallback = landscapeResult.panelWidth
- **é»˜è®¤å€¼**ï¼šæ™ºèƒ½é€‰æ‹©
- **å½±å“ç‚¹**ï¼šæ¨ªå±é¢æ¿æ˜¾ç¤ºå®Œæ•´ï¼Œé¿å…å†…å®¹è¢«æˆªæ–­
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`components/layouts/PhoneLandscapeLayout.tsx`

---

## 5. ç§»åŠ¨ç«¯é€‚é…å¸¸é‡é…ç½®ï¼ˆv1.3.34å®Œå–„ï¼‰

### MOBILE_ADAPTATION.PORTRAIT
- **ä½œç”¨**ï¼šç§»åŠ¨ç«¯ç«–å±æ¨¡å¼é€‚é…å‚æ•°
- **å‚æ•°é…ç½®**ï¼š
  - CANVAS_MARGIN: 10pxï¼ˆç”»å¸ƒè¾¹è·ï¼‰
  - SAFE_AREA_TOP: 10pxï¼ˆé¡¶éƒ¨å®‰å…¨åŒºï¼‰
  - SAFE_AREA_BOTTOM: 30pxï¼ˆåº•éƒ¨å®‰å…¨åŒºï¼‰
  - PANEL_HEIGHT: 180pxï¼ˆé¢æ¿é«˜åº¦ï¼‰
- **é»˜è®¤å€¼**ï¼šå¦‚ä¸Šæ‰€ç¤º
- **å½±å“ç‚¹**ï¼šç«–å±å¸ƒå±€é—´è·å’Œå®‰å…¨åŒºåŸŸ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`constants/canvasAdaptation.ts`

### MOBILE_ADAPTATION.LANDSCAPE
- **ä½œç”¨**ï¼šç§»åŠ¨ç«¯æ¨ªå±æ¨¡å¼é€‚é…å‚æ•°
- **å‚æ•°é…ç½®**ï¼š
  - CANVAS_MARGIN: 6pxï¼ˆç”»å¸ƒè¾¹è·ï¼‰
  - SAFE_AREA_TOP: 6pxï¼ˆé¡¶éƒ¨å®‰å…¨åŒºï¼‰
  - MIN_PANEL_WIDTH: 240pxï¼ˆé¢æ¿æœ€å°å®½åº¦ï¼‰
  - MAX_PANEL_WIDTH: 350pxï¼ˆé¢æ¿æœ€å¤§å®½åº¦ï¼‰
- **é»˜è®¤å€¼**ï¼šå¦‚ä¸Šæ‰€ç¤º
- **å½±å“ç‚¹**ï¼šæ¨ªå±å¸ƒå±€é—´è·å’Œé¢æ¿å®½åº¦èŒƒå›´
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`constants/canvasAdaptation.ts`

---

## 6. ä¼ ç»Ÿå“åº”å¼é…ç½®ï¼ˆä¿æŒå…¼å®¹ï¼‰

### canvasMaxSize
- **ä½œç”¨**ï¼šç”»å¸ƒæœ€å¤§å°ºå¯¸ï¼ˆç«–å±å¼ºåˆ¶æ­£æ–¹å½¢ï¼‰
- **å–å€¼èŒƒå›´**ï¼š320~1024ï¼ˆåƒç´ ï¼Œéšè®¾å¤‡/çª—å£åŠ¨æ€è°ƒæ•´ï¼‰
- **é»˜è®¤å€¼**ï¼šæ¡Œé¢ 800ï¼Œç§»åŠ¨ç«¯ 360
- **å½±å“ç‚¹**ï¼šç”»å¸ƒã€æ‹¼å›¾ç¼©æ”¾ã€é€‚é…
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`hooks/useResponsiveCanvasSizing.ts`ã€`components/PuzzleCanvas.tsx`

### useResponsiveCanvasSizing
- **ä½œç”¨**ï¼šå“åº”å¼ç”»å¸ƒå°ºå¯¸ç®¡ç†é’©å­
- **ç›‘å¬äº‹ä»¶**ï¼šresize, orientationchange, ResizeObserver
- **æ›´æ–°ç­–ç•¥**ï¼šåŸå­æ€§æ›´æ–°çŠ¶æ€ï¼Œé©±åŠ¨ä¸‹æ¸¸é€‚é…
- **é»˜è®¤å€¼**ï¼šå¯ç”¨å“åº”å¼ç®¡ç†
- **å½±å“ç‚¹**ï¼šç”»å¸ƒå°ºå¯¸å˜åŒ–çš„å“åº”
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`hooks/useResponsiveCanvasSizing.ts`

### useDeviceDetectionï¼ˆä¼ ç»Ÿï¼‰
- **ä½œç”¨**ï¼šä¼ ç»Ÿè®¾å¤‡æ£€æµ‹é’©å­ï¼ˆé€æ­¥è¿ç§»ä¸­ï¼‰
- **æ£€æµ‹å†…å®¹**ï¼šè®¾å¤‡ç±»å‹ã€å±å¹•æ–¹å‘ã€å°ºå¯¸ä¿¡æ¯
- **è¿ç§»çŠ¶æ€**ï¼šä¿æŒå…¼å®¹ï¼Œé€æ­¥è¿ç§»åˆ°useDevice
- **é»˜è®¤å€¼**ï¼šä¿æŒç°æœ‰é€»è¾‘
- **å½±å“ç‚¹**ï¼šä¼ ç»Ÿç»„ä»¶çš„è®¾å¤‡æ£€æµ‹
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`hooks/useDeviceDetection.ts`

---

## 7. å¸ƒå±€ç»„ä»¶é€‚é…é…ç½®

### DesktopLayouté…ç½®
- **ä½œç”¨**ï¼šæ¡Œé¢ç«¯å¸ƒå±€é…ç½®
- **å¸ƒå±€ç­–ç•¥**ï¼šå·¦ä¾§æ§åˆ¶é¢æ¿ï¼Œå³ä¾§ç”»å¸ƒåŒºåŸŸ
- **ç”»å¸ƒç®¡ç†**ï¼šä½¿ç”¨useCanvas()ç»Ÿä¸€ç®¡ç†
- **é»˜è®¤å€¼**ï¼šæ¡Œé¢ç«¯ä¸“ç”¨å¸ƒå±€
- **å½±å“ç‚¹**ï¼šæ¡Œé¢ç«¯ç”¨æˆ·ä½“éªŒ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`components/layouts/DesktopLayout.tsx`

### PhonePortraitLayouté…ç½®ï¼ˆv1.3.34ä¼˜åŒ–ï¼‰
- **ä½œç”¨**ï¼šæ‰‹æœºç«–å±å¸ƒå±€é…ç½®
- **å¸ƒå±€ç­–ç•¥**ï¼šä¸Šæ–¹ç”»å¸ƒï¼Œä¸‹æ–¹Tabé¢æ¿
- **ç”»å¸ƒè®¡ç®—**ï¼šç›´æ¥ä½¿ç”¨calculateMobilePortraitCanvasSizeè®¡ç®—
- **ä¼˜åŒ–å†…å®¹**ï¼šè§£å†³å¤§ç¼©å°åŠ¨æ€æ˜¾ç¤ºé—®é¢˜
- **é»˜è®¤å€¼**ï¼šç«–å±ä¸“ç”¨å¸ƒå±€
- **å½±å“ç‚¹**ï¼šç«–å±ç”¨æˆ·ä½“éªŒ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`components/layouts/PhonePortraitLayout.tsx`

### PhoneLandscapeLayouté…ç½®ï¼ˆv1.3.34ä¼˜åŒ–ï¼‰
- **ä½œç”¨**ï¼šæ‰‹æœºæ¨ªå±å¸ƒå±€é…ç½®
- **å¸ƒå±€ç­–ç•¥**ï¼šå·¦ä¾§Tabé¢æ¿ï¼Œå³ä¾§ç”»å¸ƒ
- **é¢æ¿å®½åº¦**ï¼šæ™ºèƒ½è®¡ç®—ï¼Œä¼˜å…ˆä½¿ç”¨ç”»å¸ƒå°ºå¯¸ç¡®ä¿æ˜¾ç¤ºå®Œæ•´
- **ä¼˜åŒ–å†…å®¹**ï¼šè§£å†³é¢æ¿æ˜¾ç¤ºä¸å®Œæ•´é—®é¢˜
- **é»˜è®¤å€¼**ï¼šæ¨ªå±ä¸“ç”¨å¸ƒå±€
- **å½±å“ç‚¹**ï¼šæ¨ªå±ç”¨æˆ·ä½“éªŒ
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`components/layouts/PhoneLandscapeLayout.tsx`

---

## 8. äº‹ä»¶ç®¡ç†é…ç½®ï¼ˆv1.3.33é‡æ„ï¼Œv1.3.34å¢å¼ºï¼‰

### useEventManager Hook
- **ä½œç”¨**ï¼šç»Ÿä¸€äº‹ä»¶ç®¡ç†Hookï¼Œæ›¿ä»£åˆ†æ•£çš„äº‹ä»¶ç›‘å¬å™¨
- **ç®¡ç†äº‹ä»¶**ï¼šresize, orientationchange, visibilitychange
- **ä¼˜åŒ–æ•ˆæœ**ï¼šäº‹ä»¶ç›‘å¬å™¨ä»çº¦20ä¸ªå‡å°‘åˆ°3ä¸ª
- **é»˜è®¤å€¼**ï¼šè‡ªåŠ¨ç®¡ç†
- **å½±å“ç‚¹**ï¼šäº‹ä»¶ç›‘å¬å™¨æ•°é‡å‡å°‘85%
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`hooks/useEventManager.ts`

### mobileEventOptimizationï¼ˆv1.3.34æ–°å¢ï¼‰
- **ä½œç”¨**ï¼šç§»åŠ¨ç«¯äº‹ä»¶ç›‘å¬å™¨ä¼˜åŒ–é…ç½®
- **ä¼˜åŒ–ç­–ç•¥**ï¼šä»åˆ†æ•£çš„resizeç›‘å¬å™¨æ•´åˆåˆ°3ä¸ªå…¨å±€ç›‘å¬å™¨
- **ç›‘å¬äº‹ä»¶**ï¼šresize, orientationchange, visibilitychange
- **é»˜è®¤å€¼**ï¼šå¯ç”¨å…¨å±€ç›‘å¬å™¨
- **å½±å“ç‚¹**ï¼šå‡å°‘å†…å­˜ä½¿ç”¨ï¼Œæå‡æ€§èƒ½
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`hooks/useCanvas.ts`, `providers/SystemProvider.tsx`

---

## 9. æ€§èƒ½ä¼˜åŒ–é…ç½®

### deviceDetectionCache
- **ä½œç”¨**ï¼šè®¾å¤‡æ£€æµ‹ç»“æœç¼“å­˜ï¼Œé¿å…é‡å¤è®¡ç®—
- **ç¼“å­˜å†…å®¹**ï¼šè®¾å¤‡ç±»å‹ã€å±å¹•æ–¹å‘ã€å°ºå¯¸ä¿¡æ¯
- **ç¼“å­˜ç­–ç•¥**ï¼šé¦–æ¬¡æ£€æµ‹æ—¶è‡ªåŠ¨ç¼“å­˜ï¼ŒçŠ¶æ€å˜åŒ–æ—¶æ›´æ–°
- **é»˜è®¤å€¼**ï¼šå¯ç”¨ç¼“å­˜
- **å½±å“ç‚¹**ï¼šæ€§èƒ½ä¼˜åŒ–ã€æ£€æµ‹ä¸€è‡´æ€§
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/core/DeviceManager.ts`

### canvasStateCache
- **ä½œç”¨**ï¼šç”»å¸ƒçŠ¶æ€ç¼“å­˜ï¼Œç»Ÿä¸€ç®¡ç†ç”»å¸ƒå°ºå¯¸ã€ç¼©æ”¾ç­‰çŠ¶æ€
- **ç¼“å­˜å†…å®¹**ï¼šç”»å¸ƒå°ºå¯¸ã€ç¼©æ”¾æ¯”ä¾‹ã€æ–¹å‘ä¿¡æ¯
- **ç¼“å­˜ç­–ç•¥**ï¼šçŠ¶æ€å˜åŒ–æ—¶è‡ªåŠ¨æ›´æ–°ç¼“å­˜
- **é»˜è®¤å€¼**ï¼šå¯ç”¨ç¼“å­˜
- **å½±å“ç‚¹**ï¼šç”»å¸ƒé€‚é…ã€çŠ¶æ€åŒæ­¥
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/core/CanvasManager.ts`

### mobileMemoryOptimizationï¼ˆv1.3.34æ–°å¢ï¼‰
- **ä½œç”¨**ï¼šç§»åŠ¨ç«¯å†…å­˜ä½¿ç”¨ä¼˜åŒ–é…ç½®
- **ä¼˜åŒ–ç­–ç•¥**ï¼šè®¾å¤‡çŠ¶æ€ç¼“å­˜ã€ç”»å¸ƒå°ºå¯¸ç¼“å­˜ã€äº‹ä»¶é˜²æŠ–
- **é˜²æŠ–å»¶è¿Ÿ**ï¼š100-300ms
- **é»˜è®¤å€¼**ï¼šå¯ç”¨æ‰€æœ‰ä¼˜åŒ–
- **å½±å“ç‚¹**ï¼šå†…å­˜ä½¿ç”¨ç¨³å®šï¼Œé¿å…å†…å­˜æ³„æ¼
- **é…ç½®/ä»£ç ä½ç½®**ï¼š`utils/core/DeviceManager.ts`, `utils/core/CanvasManager.ts`

---

## 10. é…ç½®ç¤ºä¾‹

### è®¾å¤‡æ£€æµ‹é…ç½®ç¤ºä¾‹
```typescript
// ä½¿ç”¨ç»Ÿä¸€è®¾å¤‡æ£€æµ‹
const { isMobile, isPortrait, deviceType, screenWidth, screenHeight } = useDevice();

// æ ¹æ®è®¾å¤‡ç±»å‹é€‰æ‹©å¸ƒå±€
const LayoutComponent = isMobile 
  ? (isPortrait ? PhonePortraitLayout : PhoneLandscapeLayout)
  : DesktopLayout;
```

### ç”»å¸ƒç®¡ç†é…ç½®ç¤ºä¾‹
```typescript
// ä½¿ç”¨ç»Ÿä¸€ç”»å¸ƒç®¡ç†
const { canvasSize, scale, updateCanvas } = useCanvas();

// ç§»åŠ¨ç«¯ç›´æ¥è®¡ç®—ç”»å¸ƒå°ºå¯¸
const mobileCanvasSize = isMobile && isPortrait
  ? calculateMobilePortraitCanvasSize(screenWidth, screenHeight)
  : canvasSize;
```

---

## 11. æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜
1. **è®¾å¤‡æ£€æµ‹ä¸å‡†ç¡®**ï¼šæ£€æŸ¥è®¾å¤‡æ£€æµ‹ä¼˜å…ˆçº§é…ç½®
2. **ç§»åŠ¨ç«¯å¸ƒå±€å¼‚å¸¸**ï¼šç¡®è®¤ä½¿ç”¨æ­£ç¡®çš„å¸ƒå±€ç»„ä»¶
3. **ç”»å¸ƒå°ºå¯¸ä¸æ­£ç¡®**ï¼šæ£€æŸ¥ç”»å¸ƒè®¡ç®—ç­–ç•¥é…ç½®
4. **æ¨ªå±é¢æ¿æ˜¾ç¤ºä¸å®Œæ•´**ï¼šç¡®è®¤æ™ºèƒ½é¢æ¿å®½åº¦è®¡ç®—å·²å¯ç”¨

### è°ƒè¯•æ–¹æ³•
- æ£€æŸ¥è®¾å¤‡æ£€æµ‹ç»“æœ
- éªŒè¯ç”»å¸ƒå°ºå¯¸è®¡ç®—
- ç›‘æ§äº‹ä»¶ç›‘å¬å™¨æ•°é‡
- è¿½è¸ªå¸ƒå±€ç»„ä»¶é€‰æ‹©é€»è¾‘

---

> ğŸ“– **ç›¸å…³æ–‡æ¡£**
> - [ç»Ÿä¸€æ¶æ„ç®¡ç†å™¨é…ç½®](./02-unified-managers.md)
> - [ç§»åŠ¨ç«¯é€‚é…é…ç½®](./03-mobile-adaptation.md)
> - [æ‹¼å›¾å—é€‚é…ç³»ç»Ÿé…ç½®](./12-puzzle-piece-adaptation.md)